SELECT C.CUSTOMER_ID AS CLIENTE
      ,COALESCE(SUM(CASE 
                       WHEN UPPER(M.PRODUCT_NAME) = 'SUSHI' THEN M.PRICE * 20 -- Multiplicamos por 20 porque el sushi tiene un x2 ademas de los 10 por euro
                       ELSE M.PRICE * 10 -- 10 puntos por euro gastado
                   END), 0) AS PUNTOS_POR_CLIENTE
FROM SQL_EN_LLAMAS_ALUMNOS.CASE01.CUSTOMERS C
LEFT JOIN SQL_EN_LLAMAS_ALUMNOS.CASE01.SALES S 
	ON C.CUSTOMER_ID = S.CUSTOMER_ID
LEFT JOIN SQL_EN_LLAMAS_ALUMNOS.CASE01.MENU M 
	ON S.PRODUCT_ID = M.PRODUCT_ID
GROUP BY C.CUSTOMER_ID;
